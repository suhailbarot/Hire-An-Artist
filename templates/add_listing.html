{% extends 'base.html' %}
{% load static %}
{% load widget_tweaks %}




    {% load bootstrap %}
    {% block page_title %}Add A Listing{% endblock %}
    {% block body_block %}
   <script src="{% static 'jcrop/js/jquery.min.js' %}"></script>
<script src="{% static 'jcrop/js/jquery.Jcrop.min.js' %}"></script>
<link rel="stylesheet" href="{% static 'jcrop/css/jquery.Jcrop.css' %}" type="text/css" />


<script type="text/javascript">
$(document).ready(function(){


function readURL(input) {
        if (input.files && input.files[0]) {
            var reader = new FileReader();
            
            reader.onload = function (e) {
                $('#blah').attr('src', e.target.result);
                $('.crop').Jcrop({
      
                  onSelect: updateCoords,
                    
                        bgOpacity:   .4,
                        setSelect:   [ 100, 100, 50, 50 ],
                });
            }
            
            reader.readAsDataURL(input.files[0]);
        }
    }
    
    $("#id_profile_pic").change(function(){

        console.log(this);
        readURL(this);
    });

  function updateCoords(c)
  {
    console.log(c);
    $('#id_x').val(c.x);
    $('#id_y').val(c.y);
    $('#id_x2').val(c.w);
    $('#id_y2').val(c.h);
  };


});


 

</script>
<style type="text/css">
 #blah {
    background-color: #FFF;

    font-size: 24px;
    display: block;
  }
</style>
    
<div class= "row">
    <div class = " col-md-offset-2 col-md-8" >

<form method="post" enctype="multipart/form-data">

    {% csrf_token %}

    <h2>Basics</h2>
<img id="blah" class="crop" src="#" alt="your image" />

  {{form |bootstrap}}

        
  <h2>Projects</h2>

    {{ formset.management_form |bootstrap}}

    {% for formi in formset %}
        <h4>Project {{ forloop.counter }}</h4>

        {% for field in formi %}
            {% if field.label != 'Listing' and field.label != 'Id' %}
            {% endif %}
                {{ field|bootstrap }}
                {{ field.errors }}
        <br/>
        {% endfor %}
    {% endfor %}

    <input type="submit" class = "btn btn-default" value="submit">

</form>
</div>
{% endblock %}